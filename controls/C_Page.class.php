<?phprequire_once dirname(__FILE__) . '/../models/DB.class.php';class C_Page extends C_Base {    function __construct() {        parent::__construct();        $this->constElements();    }    public function constElements() {        if (isset($_SESSION['cart'])) {            foreach ($_SESSION['cart'] as $key) {                $total[] = $key['totalPrice'];                $totalq[] = $key['quantity'];            }            if ($total && $totalq) {                $_SESSION['total'] = array_sum($total) . '$';                $_SESSION['totalq'] = array_sum($totalq);            } else {                $_SESSION['total'] = null;                $_SESSION['totalq'] = null;            }        }        $this->head = $this->Template('v_head.tmpl', array());        $this->header = $this->Template('v_header.tmpl', array());    }    public function action_index() {        $this->title .= 'MainPage';        $obj = SQL::Instance();        $data = $obj->Select('SELECT item_id,title, price, photo,info FROM items LIMIT 4');        $this->content = $this->Template('v_products.tmpl', $data);    }    public function action_login() {        $this->title .= 'loinPage';        $this->content = $this->Template('v_auth.tmpl', array());    }    public function action_logout() {        $this->title .= '';        $_SESSION['login'] = null;        $_SESSION['pass'] = null;        header("Location: index.php");    }    public function action_persArea() {        $this->title .= 'UserPage';        $data = $_SESSION['userInfo'];        $this->content = $this->Template('v_userRoom.tmpl', $data);    }    public function action_productPage() {        $this->title .= 'product';        if (!$_GET['id'])            die();        $id = (int) $_GET['id'];        $obj = SQL::Instance();        $sql = $obj->Select('SELECT item_id, title, price, photo,info FROM items WHERE item_id = ' . $id . '');        foreach ($sql as $key => $value) {            $data = $value;        }        $this->content = $this->Template('v_prodPage.tmpl', $data);    }    public function action_cardPage() {        $this->title .= 'cart';        $data = $_SESSION['cart'];        $this->content = $this->Template('v_cardPage.tmpl', $data);    }    public function action_idelete() {        $this->title .= '';        if ($_GET['id']) {            $id = (int) $_GET['id'];            if ($_SESSION['cart'][$id]) {                unset($_SESSION['cart'][$id]);                header("Location: index.php?c=page&act=cardPage");            }        }    }    public function action_deleteAll() {        $this->title .= '';        if ($_SESSION['cart']) {            $_SESSION['total'] = null;            $_SESSION['totalq'] = null;            $_SESSION['cart'] = null;        }        header("Location: index.php?c=page&act=cardPage");    }    public function action_findThis() {        $this->title .= 'OrderInfo';        if ($_GET['val']) {            $orderId = $_GET['val'];            $obj = SQL::Instance();            $sql = $obj->Select("SELECT orders.order_id AS `order`, users.login AS `login`, CONCAT(users.name ,' ',users.surname ) AS `customer`, orders.create_time AS `create_time`,orders.amount AS `summ`,order_status.status_name AS `order_status`, order_status.id_order_status AS `order_status_num` FROM `orders`				INNER JOIN `users` ON orders.user_id = users.user_id				INNER JOIN  `order_status` ON orders.id_order_status = order_status.id_order_status WHERE orders.order_id = '$orderId'");            if (sizeof($sql) == 1) {                foreach ($sql as $key => $value) {                    $data = $value;                }                $this->content = $this->Template('v_orderStatus.tmpl', $data);            } else {                $data = ['error' => 'empty order! Try again'];                $this->content = $this->Template('v_test.tmpl', $data);            }        } else {            $data = ['error' => 'empty order! Try again'];            $this->content = $this->Template('v_test.tmpl', $data);        }    }}